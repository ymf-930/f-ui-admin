import{g as I}from"./depart.api-9ff2b259.js";import{a9 as K,k as N,a as U,w as t,D as l,o as T,c as o,q as m,d as c,h as q,T as E,b as j,v as z,g as L,t as M}from"./vendor-3647c542.js";import{j as A}from"./index-7fbf4c2e.js";import{a as G}from"./chunk-f-ui-one-208e726e.js";import{u as H}from"./useForm-37e50604.js";import"./chunk-brace-c1a5251e.js";const J={name:"Depart",setup(){const h=N(null),a=N(null),i=N({}),e=N({}),{formRef:F,editStatus:R,pageStatus:f,editLoading:p,openCreate:C,openEdit:_,backNormal:g,submitForm:u,resetForm:d}=H();function V(r,s){r.selected?(a.value=r,e.value=s,S()):x()}function w(r){if(r==="root"&&y(),r==="child"){y();const s=a.value;i.value.parentId=s.id,i.value.parentName=s.text}}function v(r="edit"){if(r==="edit"){const s=e.value,D=a.value,b=s[D.nodeKey].parent,B=b||b===0?s[b].node:{};i.value=D?{...A(D),parentId:b===0?"":B.id,parentName:B.title}:{};return}i.value={text:"",deptCode:"",status:"1",desc:"",parentId:"",parentName:void 0}}function x(){a.value=null,e.value=null,i.value={},g()}function y(){v("create"),C()}function S(){v("edit"),_()}function k(){u(()=>{p.value=!0;const r=f.value;setTimeout(()=>{G.success(`${r.isCreate?"新增":"修改"}成功！`),g();const s=a.value?[a.value.nodeKey]:[];h.value&&h.value.reloadTree(s),p.value=!1},1e3)})}function n(){v(R.value),d()}return{treeRef:h,getDepartTree:I,currentNode:a,copyNode:i,handleSelect:V,handleSubmit:k,handleResetForm:n,handleCommand:w,formRef:F,pageStatus:f,editLoading:p,submitForm:u,resetForm:d,ruleValidate:{text:[{required:!0,message:"部门名称必填",trigger:"blur"}],deptCode:[{required:!0,message:"部门编码必填",trigger:"blur"}]}}}},O={class:"pl-16"},P={flex:"main:justify cross:center",style:{"font-weight":"normal"}},Q={class:"top"},W=c("span",{class:"ml-5"},"编辑部门",-1),X={class:"right"},Y={style:{position:"relative","min-height":"100px",overflow:"hidden"}},Z={style:{position:"absolute",width:"100%"}},$={key:0,class:"pt-8"},ee=c("span",null,"启用",-1),te=c("span",null,"禁用",-1);function oe(h,a,i,e,F,R){const f=l("f-dropdown-item"),p=l("base-tree"),C=l("iconfont"),_=l("f-button"),g=l("f-alert"),u=l("f-input"),d=l("f-form-item"),V=l("f-switch"),w=l("f-form"),v=l("f-col"),x=l("f-row"),y=l("f-card"),S=l("page-cube-wrapper"),k=l("page-container");return T(),U(k,{"hide-header":"","inner-scroll":""},{default:t(()=>[o(S,null,{left:t(()=>[o(p,{ref:"treeRef","tree-title":"部门列表","show-filter":"",fetch:e.getDepartTree,onSelectChange:e.handleSelect,onCommand:e.handleCommand},{ctrl:t(()=>[o(f,{name:"root",divided:""},{default:t(()=>[m("增加根节点")]),_:1}),o(f,{name:"child",disabled:!e.currentNode},{default:t(()=>[m("增加子节点")]),_:1},8,["disabled"])]),_:1},8,["fetch","onSelectChange","onCommand"])]),default:t(()=>[c("div",O,[o(y,{bordered:!1,class:"card-panel",shadow:"never"},{header:t(()=>[c("div",P,[c("div",Q,[o(C,{icon:"apartment",color:"primary",bg:"",round:""}),W]),c("div",X,[e.currentNode?(T(),U(_,{key:0,type:"text",size:"small",onClick:a[0]||(a[0]=n=>e.handleCommand("child"))},{default:t(()=>[m(" 新增子部门 ")]),_:1})):q("",!0)])])]),default:t(()=>[c("div",Y,[o(E,{name:"fade-in"},{default:t(()=>[c("div",Z,[j(o(g,null,{default:t(()=>[m("点选左侧部门，进行编辑操作")]),_:1},512),[[z,e.pageStatus.isNormal]])])]),_:1}),o(E,{name:"fade-transverse"},{default:t(()=>[e.pageStatus.isNormal?q("",!0):(T(),L("div",$,[o(x,null,{default:t(()=>[o(v,{span:"14"},{default:t(()=>[o(w,{ref:"formRef",model:e.copyNode,rules:e.ruleValidate,"label-width":"100px","label-suffix":":"},{default:t(()=>[o(d,{label:"父级组织"},{default:t(()=>[o(u,{modelValue:e.copyNode.parentName,"onUpdate:modelValue":a[1]||(a[1]=n=>e.copyNode.parentName=n),disabled:""},null,8,["modelValue"])]),_:1}),o(d,{label:"部门名称",prop:"text"},{default:t(()=>[o(u,{modelValue:e.copyNode.text,"onUpdate:modelValue":a[2]||(a[2]=n=>e.copyNode.text=n),placeholder:"输入部门名称",clearable:""},null,8,["modelValue"])]),_:1}),o(d,{label:"部门编码",prop:"deptCode"},{default:t(()=>[o(u,{modelValue:e.copyNode.deptCode,"onUpdate:modelValue":a[3]||(a[3]=n=>e.copyNode.deptCode=n),placeholder:"输入部门编码",clearable:""},null,8,["modelValue"])]),_:1}),o(d,{label:"部门状态"},{default:t(()=>[o(V,{size:"large",modelValue:e.copyNode.status,"onUpdate:modelValue":a[4]||(a[4]=n=>e.copyNode.status=n),"true-value":"1","false-value":"0"},{open:t(()=>[ee]),close:t(()=>[te]),_:1},8,["modelValue"])]),_:1}),o(d,{label:"部门描述"},{default:t(()=>[o(u,{modelValue:e.copyNode.desc,"onUpdate:modelValue":a[5]||(a[5]=n=>e.copyNode.desc=n),type:"textarea",placeholder:"输入部门描述"},null,8,["modelValue"])]),_:1}),o(d,null,{default:t(()=>[o(_,{type:"primary",onClick:e.handleSubmit,loading:e.editLoading},{default:t(()=>[m(M(e.pageStatus.isCreate?"提交数据":"更新数据"),1)]),_:1},8,["onClick","loading"]),o(_,{onClick:e.handleResetForm},{default:t(()=>[m("重置")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})]))]),_:1})])]),_:1})])]),_:1})]),_:1})}const ce=K(J,[["render",oe]]);export{ce as default};
