import{i as q,k as E}from"./index-3b6599e4.js";import{a9 as K,k as C,D as n,a as R,w as t,o as V,c as o,q as u,d as f,T as U,b as P,v as L,g as j,t as z,h as A}from"./vendor-19c9365f.js";import{u as G}from"./useForm-7af87cd7.js";import{a as H}from"./chunk-f-ui-one-07ca1cee.js";import"./chunk-brace-bde7130a.js";import"./chunk-mockjs-2decca2f.js";function I(){return q({url:"/menu/tree",method:"get"})}const J={name:"Menu",setup(){const h=C(null),a=C(null),i=C({}),e=C({}),{formRef:B,editStatus:D,pageStatus:m,editLoading:p,openCreate:w,openEdit:v,backNormal:s,submitForm:c,resetForm:g}=G();function y(r,d){r.selected?(a.value=r,e.value=d,x()):S()}function k(r){if(r==="root"&&b(),r==="child"){b();const d=a.value;i.value.parentPath=d.path,i.value.parentName=d.title}}function _(r="edit"){if(r==="edit"){const d=e.value,F=a.value,N=d[F.nodeKey].parent,M=N||N===0?d[N].node:{};i.value=F?{...E(F),parentPath:N===0?"":M.path,parentName:M.title}:{};return}i.value={path:"",title:"",icon:"",parentPath:"",parentName:void 0}}function S(){a.value=null,e.value=null,i.value={},s()}function b(){_("create"),w()}function x(){_("edit"),v()}function T(){c(()=>{p.value=!0;const r=m.value;setTimeout(()=>{H.success(`${r.isCreate?"新增":"修改"}成功！`),s();const d=a.value?[a.value.nodeKey]:[];h.value&&h.value.reloadTree(d),p.value=!1},1e3)})}function l(){_(D.value),g()}return{treeRef:h,getMenuTree:I,currentNode:a,copyNode:i,handleSelect:y,handleSubmit:T,handleResetForm:l,handleCommand:k,formRef:B,pageStatus:m,editLoading:p,submitForm:c,resetForm:g,ruleValidate:{path:[{required:!0,message:"菜单路径必填",trigger:"blur"}],title:[{required:!0,message:"菜单名称必填",trigger:"blur"}]}}}},O={class:"pl-16"},Q={flex:"main:justify cross:center",style:{"font-weight":"normal"}},W={class:"top"},X=f("span",{class:"ml-5"},"编辑菜单",-1),Y={style:{position:"relative","min-height":"100px",overflow:"hidden"}},Z={style:{position:"absolute",width:"100%"}},$={key:0,class:"pt-8"};function ee(h,a,i,e,B,D){const m=n("f-dropdown-item"),p=n("base-tree"),w=n("iconfont"),v=n("f-alert"),s=n("f-input"),c=n("f-form-item"),g=n("f-icon-select"),y=n("f-button"),k=n("f-form"),_=n("f-col"),S=n("f-row"),b=n("f-card"),x=n("page-cube-wrapper"),T=n("page-container");return V(),R(T,{"inner-scroll":"","hide-header":""},{default:t(()=>[o(x,null,{left:t(()=>[o(p,{ref:"treeRef","tree-title":"菜单列表","show-filter":"","title-key":"title",fetch:e.getMenuTree,onSelectChange:e.handleSelect,onCommand:e.handleCommand},{ctrl:t(()=>[o(m,{name:"root",divided:""},{default:t(()=>[u("增加根节点")]),_:1}),o(m,{name:"child",disabled:!e.currentNode},{default:t(()=>[u("增加子节点")]),_:1},8,["disabled"])]),_:1},8,["fetch","onSelectChange","onCommand"])]),default:t(()=>[f("div",O,[o(b,{bordered:!1,class:"card-panel",shadow:"never"},{header:t(()=>[f("div",Q,[f("div",W,[o(w,{icon:"menu",color:"primary",bg:"",round:""}),X])])]),default:t(()=>[f("div",Y,[o(U,{name:"fade-in"},{default:t(()=>[f("div",Z,[P(o(v,null,{default:t(()=>[u("点选左侧菜单，进行编辑操作")]),_:1},512),[[L,e.pageStatus.isNormal]])])]),_:1}),o(U,{name:"fade-transverse"},{default:t(()=>[e.pageStatus.isNormal?A("",!0):(V(),j("div",$,[e.copyNode.path!=="root"?(V(),R(S,{key:0},{default:t(()=>[o(_,{span:"14"},{default:t(()=>[o(k,{ref:"formRef",model:e.copyNode,rules:e.ruleValidate,"label-width":"100px","label-suffix":":"},{default:t(()=>[o(c,{label:"父级菜单"},{default:t(()=>[o(s,{modelValue:e.copyNode.parentName,"onUpdate:modelValue":a[0]||(a[0]=l=>e.copyNode.parentName=l),disabled:""},null,8,["modelValue"])]),_:1}),o(c,{label:"菜单名称",prop:"title"},{default:t(()=>[o(s,{modelValue:e.copyNode.title,"onUpdate:modelValue":a[1]||(a[1]=l=>e.copyNode.title=l),placeholder:"输入菜单名称",clearable:""},null,8,["modelValue"])]),_:1}),o(c,{label:"菜单路径",prop:"path"},{default:t(()=>[o(s,{modelValue:e.copyNode.path,"onUpdate:modelValue":a[2]||(a[2]=l=>e.copyNode.path=l),placeholder:"输入菜单路径",clearable:""},null,8,["modelValue"])]),_:1}),o(c,{label:"菜单图标"},{default:t(()=>[o(g,{modelValue:e.copyNode.icon,"onUpdate:modelValue":a[3]||(a[3]=l=>e.copyNode.icon=l)},null,8,["modelValue"])]),_:1}),o(c,null,{default:t(()=>[o(y,{type:"primary",onClick:e.handleSubmit,loading:e.editLoading},{default:t(()=>[u(z(e.pageStatus.isCreate?"提交数据":"更新数据"),1)]),_:1},8,["onClick","loading"]),o(y,{onClick:e.handleResetForm},{default:t(()=>[u("重置")]),_:1},8,["onClick"])]),_:1})]),_:1},8,["model","rules"])]),_:1})]),_:1})):(V(),R(v,{key:1,type:"error","show-icon":""},{default:t(()=>[u("系统菜单根节点不可编辑")]),_:1}))]))]),_:1})])]),_:1})])]),_:1})]),_:1})}const de=K(J,[["render",ee]]);export{de as default};
